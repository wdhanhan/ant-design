{"version":3,"sources":["components/upload/demo/drag-sorting.tsx?techStack=react"],"sourcesContent":["import '/Users/vagusx/Projects/ant-design/components/upload/demo/drag-sorting.tsx?watch=parent';import React, { useState } from 'react';\nimport { UploadOutlined } from '@ant-design/icons';\nimport type { DragEndEvent } from '@dnd-kit/core';\nimport { DndContext, PointerSensor, useSensor } from '@dnd-kit/core';\nimport {\n  arrayMove,\n  SortableContext,\n  useSortable,\n  verticalListSortingStrategy,\n} from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\nimport { Button, Upload } from 'antd';\nimport type { UploadFile, UploadProps } from 'antd';\n\ninterface DraggableUploadListItemProps {\n  originNode: React.ReactElement<any, string | React.JSXElementConstructor<any>>;\n  file: UploadFile<any>;\n}\n\nconst DraggableUploadListItem = ({ originNode, file }: DraggableUploadListItemProps) => {\n  const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({\n    id: file.uid,\n  });\n\n  const style: React.CSSProperties = {\n    transform: CSS.Translate.toString(transform),\n    transition,\n    cursor: 'move',\n  };\n\n  return (\n    <div\n      ref={setNodeRef}\n      style={style}\n      // prevent preview event when drag end\n      className={isDragging ? 'is-dragging' : ''}\n      {...attributes}\n      {...listeners}\n    >\n      {/* hide error tooltip when dragging */}\n      {file.status === 'error' && isDragging ? originNode.props.children : originNode}\n    </div>\n  );\n};\n\nconst App: React.FC = () => {\n  const [fileList, setFileList] = useState<UploadFile[]>([\n    {\n      uid: '-1',\n      name: 'image1.png',\n      status: 'done',\n      url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png',\n    },\n    {\n      uid: '-2',\n      name: 'image2.png',\n      status: 'done',\n      url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png',\n    },\n    {\n      uid: '-3',\n      name: 'image3.png',\n      status: 'done',\n      url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png',\n    },\n    {\n      uid: '-4',\n      name: 'image4.png',\n      status: 'done',\n      url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png',\n    },\n    {\n      uid: '-5',\n      name: 'image.png',\n      status: 'error',\n    },\n  ]);\n\n  const sensor = useSensor(PointerSensor, {\n    activationConstraint: { distance: 10 },\n  });\n\n  const onDragEnd = ({ active, over }: DragEndEvent) => {\n    if (active.id !== over?.id) {\n      setFileList((prev) => {\n        const activeIndex = prev.findIndex((i) => i.uid === active.id);\n        const overIndex = prev.findIndex((i) => i.uid === over?.id);\n        return arrayMove(prev, activeIndex, overIndex);\n      });\n    }\n  };\n\n  const onChange: UploadProps['onChange'] = ({ fileList: newFileList }) => {\n    setFileList(newFileList);\n  };\n\n  return (\n    <DndContext sensors={[sensor]} onDragEnd={onDragEnd}>\n      <SortableContext items={fileList.map((i) => i.uid)} strategy={verticalListSortingStrategy}>\n        <Upload\n          action=\"https://660d2bd96ddfa2943b33731c.mockapi.io/api/upload\"\n          fileList={fileList}\n          onChange={onChange}\n          itemRender={(originNode, file) => (\n            <DraggableUploadListItem originNode={originNode} file={file} />\n          )}\n        >\n          <Button icon={<UploadOutlined />}>Click to Upload</Button>\n        </Upload>\n      </SortableContext>\n    </DndContext>\n  );\n};\n\nexport default App;\n"],"names":[],"mappings":"qOAkHA,+CAAA,4BAlHO,oBAAyH,gBACjG,gBAEsB,gBAM9C,gBACa,gBACW,YAQ/B,IAAM,EAA0B,CAAC,CAAE,WAAA,CAAU,CAAE,KAAA,CAAI,CAAgC,IACjF,GAAM,CAAE,WAAA,CAAU,CAAE,UAAA,CAAS,CAAE,WAAA,CAAU,CAAE,UAAA,CAAS,CAAE,WAAA,CAAU,CAAE,WAAA,CAAU,CAAE,CAAG,GAAA,aAAW,EAAC,CAC3F,GAAI,EAAK,GAAG,AACd,GAEM,EAA6B,CACjC,UAAW,KAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,GAClC,WAAA,EACA,OAAQ,MACV,EAEA,MACE,UAAC,OACC,IAAK,EACL,MAAO,EAEP,UAAW,EAAa,cAAgB,GACvC,GAAG,CAAU,CACb,GAAG,CAAS,UAGZ,AAAgB,UAAhB,EAAK,MAAM,EAAgB,EAAa,EAAW,KAAK,CAAC,QAAQ,CAAG,IAG3E,MAuEA,EArEsB,KACpB,GAAM,CAAC,EAAU,EAAY,CAAG,GAAA,UAAQ,EAAe,CACrD,CACE,IAAK,KACL,KAAM,aACN,OAAQ,OACR,IAAK,8EACP,EACA,CACE,IAAK,KACL,KAAM,aACN,OAAQ,OACR,IAAK,8EACP,EACA,CACE,IAAK,KACL,KAAM,aACN,OAAQ,OACR,IAAK,8EACP,EACA,CACE,IAAK,KACL,KAAM,aACN,OAAQ,OACR,IAAK,8EACP,EACA,CACE,IAAK,KACL,KAAM,YACN,OAAQ,OACV,EACD,EAEK,EAAS,GAAA,WAAS,EAAC,eAAa,CAAE,CACtC,qBAAsB,CAAE,SAAU,EAAG,CACvC,GAgBA,MACE,UAAC,YAAU,EAAC,QAAS,CAAC,EAAO,CAAE,UAff,CAAC,CAAE,OAAA,CAAM,CAAE,KAAA,CAAI,CAAgB,IAC3C,EAAO,EAAE,UAAK,SAAA,EAAM,EAAE,GACxB,EAAY,AAAC,IACX,IAAM,EAAc,EAAK,SAAS,CAAC,AAAC,GAAM,EAAE,GAAG,GAAK,EAAO,EAAE,EACvD,EAAY,EAAK,SAAS,CAAC,AAAC,GAAM,EAAE,GAAG,UAAK,SAAA,EAAM,EAAE,GAC1D,MAAO,GAAA,WAAS,EAAC,EAAM,EAAa,GACtC,GAEJ,WAQI,UAAC,iBAAe,EAAC,MAAO,EAAS,GAAG,CAAC,AAAC,GAAM,EAAE,GAAG,EAAG,SAAU,6BAA2B,UACvF,UAAC,QAAM,EACL,OAAO,yDACP,SAAU,EACV,SAVkC,CAAC,CAAE,SAAU,CAAW,CAAE,IAClE,EAAY,GACd,EASQ,WAAY,CAAC,EAAY,IACvB,UAAC,GAAwB,WAAY,EAAY,KAAM,aAGzD,UAAC,QAAM,EAAC,KAAM,UAAC,gBAAc,cAAK,0BAK5C"}