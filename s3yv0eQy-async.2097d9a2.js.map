{"version":3,"sources":["components/calendar/demo/lunar.tsx?techStack=react"],"sourcesContent":["import '/Users/vagusx/Projects/ant-design/components/calendar/demo/lunar.tsx?watch=parent';import React from 'react';\nimport { Calendar, Col, Radio, Row, Select } from 'antd';\nimport type { CalendarProps } from 'antd';\nimport { createStyles } from 'antd-style';\nimport classNames from 'classnames';\nimport dayjs from 'dayjs';\nimport type { Dayjs } from 'dayjs';\nimport { HolidayUtil, Lunar } from 'lunar-typescript';\n\nconst useStyle = createStyles(({ token, css, cx }) => {\n  const lunar = css`\n    color: ${token.colorTextTertiary};\n    font-size: ${token.fontSizeSM}px;\n  `;\n  return {\n    wrapper: css`\n      width: 450px;\n      border: 1px solid ${token.colorBorderSecondary};\n      border-radius: ${token.borderRadiusOuter};\n      padding: 5px;\n    `,\n    dateCell: css`\n      position: relative;\n      &:before {\n        content: '';\n        position: absolute;\n        inset-inline-start: 0;\n        inset-inline-end: 0;\n        top: 0;\n        bottom: 0;\n        margin: auto;\n        max-width: 40px;\n        max-height: 40px;\n        background: transparent;\n        transition: background-color 300ms;\n        border-radius: ${token.borderRadiusOuter}px;\n        border: 1px solid transparent;\n        box-sizing: border-box;\n      }\n      &:hover:before {\n        background: rgba(0, 0, 0, 0.04);\n      }\n    `,\n    today: css`\n      &:before {\n        border: 1px solid ${token.colorPrimary};\n      }\n    `,\n    text: css`\n      position: relative;\n      z-index: 1;\n    `,\n    lunar,\n    current: css`\n      color: ${token.colorTextLightSolid};\n      &:before {\n        background: ${token.colorPrimary};\n      }\n      &:hover:before {\n        background: ${token.colorPrimary};\n        opacity: 0.8;\n      }\n      .${cx(lunar)} {\n        color: ${token.colorTextLightSolid};\n        opacity: 0.9;\n      }\n    `,\n    monthCell: css`\n      width: 120px;\n      color: ${token.colorTextBase};\n      border-radius: ${token.borderRadiusOuter}px;\n      padding: 5px 0;\n      &:hover {\n        background: rgba(0, 0, 0, 0.04);\n      }\n    `,\n    monthCellCurrent: css`\n      color: ${token.colorTextLightSolid};\n      background: ${token.colorPrimary};\n      &:hover {\n        background: ${token.colorPrimary};\n        opacity: 0.8;\n      }\n    `,\n    weekend: css`\n      color: ${token.colorError};\n      &.gray {\n        opacity: 0.4;\n      }\n    `,\n  };\n});\n\nconst App: React.FC = () => {\n  const { styles } = useStyle({ test: true });\n\n  const [selectDate, setSelectDate] = React.useState<Dayjs>(dayjs());\n  const [panelDateDate, setPanelDate] = React.useState<Dayjs>(dayjs());\n\n  const onPanelChange = (value: Dayjs, mode: CalendarProps<Dayjs>['mode']) => {\n    console.log(value.format('YYYY-MM-DD'), mode);\n    setPanelDate(value);\n  };\n\n  const onDateChange: CalendarProps<Dayjs>['onSelect'] = (value, selectInfo) => {\n    if (selectInfo.source === 'date') {\n      setSelectDate(value);\n    }\n  };\n\n  const cellRender: CalendarProps<Dayjs>['fullCellRender'] = (date, info) => {\n    const d = Lunar.fromDate(date.toDate());\n    const lunar = d.getDayInChinese();\n    const solarTerm = d.getJieQi();\n    const isWeekend = date.day() === 6 || date.day() === 0;\n    const h = HolidayUtil.getHoliday(date.get('year'), date.get('month') + 1, date.get('date'));\n    const displayHoliday = h?.getTarget() === h?.getDay() ? h?.getName() : undefined;\n    if (info.type === 'date') {\n      return React.cloneElement(info.originNode, {\n        ...info.originNode.props,\n        className: classNames(styles.dateCell, {\n          [styles.current]: selectDate.isSame(date, 'date'),\n          [styles.today]: date.isSame(dayjs(), 'date'),\n        }),\n        children: (\n          <div className={styles.text}>\n            <span\n              className={classNames({\n                [styles.weekend]: isWeekend,\n                gray: !panelDateDate.isSame(date, 'month'),\n              })}\n            >\n              {date.get('date')}\n            </span>\n            {info.type === 'date' && (\n              <div className={styles.lunar}>{displayHoliday || solarTerm || lunar}</div>\n            )}\n          </div>\n        ),\n      });\n    }\n\n    if (info.type === 'month') {\n      // Due to the fact that a solar month is part of the lunar month X and part of the lunar month X+1,\n      // when rendering a month, always take X as the lunar month of the month\n      const d2 = Lunar.fromDate(new Date(date.get('year'), date.get('month')));\n      const month = d2.getMonthInChinese();\n      return (\n        <div\n          className={classNames(styles.monthCell, {\n            [styles.monthCellCurrent]: selectDate.isSame(date, 'month'),\n          })}\n        >\n          {date.get('month') + 1}月（{month}月）\n        </div>\n      );\n    }\n  };\n\n  const getYearLabel = (year: number) => {\n    const d = Lunar.fromDate(new Date(year + 1, 0));\n    return `${d.getYearInChinese()}年（${d.getYearInGanZhi()}${d.getYearShengXiao()}年）`;\n  };\n\n  const getMonthLabel = (month: number, value: Dayjs) => {\n    const d = Lunar.fromDate(new Date(value.year(), month));\n    const lunar = d.getMonthInChinese();\n    return `${month + 1}月（${lunar}月）`;\n  };\n\n  return (\n    <div className={styles.wrapper}>\n      <Calendar\n        fullCellRender={cellRender}\n        fullscreen={false}\n        onPanelChange={onPanelChange}\n        onSelect={onDateChange}\n        headerRender={({ value, type, onChange, onTypeChange }) => {\n          const start = 0;\n          const end = 12;\n          const monthOptions = [];\n\n          let current = value.clone();\n          const localeData = value.localeData();\n          const months = [];\n          for (let i = 0; i < 12; i++) {\n            current = current.month(i);\n            months.push(localeData.monthsShort(current));\n          }\n\n          for (let i = start; i < end; i++) {\n            monthOptions.push({\n              label: getMonthLabel(i, value),\n              value: i,\n            });\n          }\n\n          const year = value.year();\n          const month = value.month();\n          const options = [];\n          for (let i = year - 10; i < year + 10; i += 1) {\n            options.push({\n              label: getYearLabel(i),\n              value: i,\n            });\n          }\n          return (\n            <Row justify=\"end\" gutter={8} style={{ padding: 8 }}>\n              <Col>\n                <Select\n                  size=\"small\"\n                  popupMatchSelectWidth={false}\n                  className=\"my-year-select\"\n                  value={year}\n                  options={options}\n                  onChange={(newYear) => {\n                    const now = value.clone().year(newYear);\n                    onChange(now);\n                  }}\n                />\n              </Col>\n              <Col>\n                <Select\n                  size=\"small\"\n                  popupMatchSelectWidth={false}\n                  value={month}\n                  options={monthOptions}\n                  onChange={(newMonth) => {\n                    const now = value.clone().month(newMonth);\n                    onChange(now);\n                  }}\n                />\n              </Col>\n              <Col>\n                <Radio.Group\n                  size=\"small\"\n                  onChange={(e) => onTypeChange(e.target.value)}\n                  value={type}\n                >\n                  <Radio.Button value=\"month\">月</Radio.Button>\n                  <Radio.Button value=\"year\">年</Radio.Button>\n                </Radio.Group>\n              </Col>\n            </Row>\n          );\n        }}\n      />\n    </div>\n  );\n};\n\nexport default App;\n"],"names":[],"mappings":"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"}